{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from 'react';\nimport { httpClient } from \"../../../util/Api\";\nexport const useProvideAuth = _ref => {\n  _s();\n\n  let {\n    user\n  } = _ref;\n  const [authUser, setAuthUser] = useState(null);\n  const [error, setError] = useState('');\n  const [isLoadingUser, setLoadingUser] = useState(true);\n  const [isLoading, setLoading] = useState(false);\n  console.log(\"ussess\", user);\n\n  const fetchStart = () => {\n    setLoading(true);\n    setError('');\n  };\n\n  const fetchSuccess = () => {\n    setLoading(false);\n    setError('');\n  };\n\n  const fetchError = error => {\n    setLoading(false);\n    setError(error);\n  };\n\n  const userLogin = (user, callbackFun) => {\n    console.log(\"user\", user);\n    fetchStart();\n    httpClient // .post('/login', user)\n    .get('login?username=' + user.username + '&password=' + user.password, user).then(_ref2 => {\n      let {\n        data\n      } = _ref2;\n\n      if (data.result) {\n        fetchSuccess();\n        httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n        localStorage.setItem('token', data.token.access_token);\n        getAuthUser();\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n\n  const userSignup = (user, callbackFun) => {\n    fetchStart();\n    httpClient.post('auth/register', user).then(_ref3 => {\n      let {\n        data\n      } = _ref3;\n\n      if (data.result) {\n        fetchSuccess();\n        localStorage.setItem('token', data.token.access_token);\n        httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n        getAuthUser();\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n\n  const sendPasswordResetEmail = (username, callbackFun) => {\n    fetchStart();\n    setTimeout(() => {\n      fetchSuccess();\n      if (callbackFun) callbackFun();\n    }, 300);\n  };\n\n  const confirmPasswordReset = (code, password, callbackFun) => {\n    fetchStart();\n    setTimeout(() => {\n      fetchSuccess();\n      if (callbackFun) callbackFun();\n    }, 300);\n  };\n\n  const renderSocialMediaLogin = () => null;\n\n  const userSignOut = callbackFun => {\n    fetchStart();\n    httpClient.post('auth/logout').then(_ref4 => {\n      let {\n        data\n      } = _ref4;\n\n      if (data.result) {\n        fetchSuccess();\n        httpClient.defaults.headers.common['Authorization'] = '';\n        localStorage.removeItem('token');\n        setAuthUser(false);\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n\n  const getAuthUser = user => {\n    fetchStart();\n    httpClient // .post('/login')\n    .get('login?username=' + user.username + '&password=' + user.password, user).then(_ref5 => {\n      let {\n        data\n      } = _ref5;\n\n      if (data.user) {\n        fetchSuccess();\n        setAuthUser(data.user);\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      httpClient.defaults.headers.common['Authorization'] = '';\n      fetchError(error.message);\n    });\n  }; // Subscribe to user on mount\n  // Because this sets state in the callback it will cause any ...\n  // ... component that utilizes this hook to re-render with the ...\n  // ... latest auth object.\n\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n    }\n\n    const aaaa = user => {\n      httpClient.get('login?username=' + user.username + '&password=' + user.password, user) // .get(  'login?username=&password=')\n      .then(_ref6 => {\n        let {\n          data\n        } = _ref6;\n\n        if (data.user) {\n          setAuthUser(data.user);\n        }\n\n        setLoadingUser(false);\n      }).catch(function () {\n        localStorage.removeItem('token');\n        httpClient.defaults.headers.common['Authorization'] = '';\n        setLoadingUser(false);\n      });\n    };\n  }, []); // Return the user object and auth methods\n\n  return {\n    isLoadingUser,\n    isLoading,\n    authUser,\n    error,\n    setError,\n    setAuthUser,\n    getAuthUser,\n    userLogin,\n    userSignup,\n    userSignOut,\n    renderSocialMediaLogin,\n    sendPasswordResetEmail,\n    confirmPasswordReset\n  };\n};\n\n_s(useProvideAuth, \"s4jthY36/nvZN3itu04Ag9XzSXY=\");","map":{"version":3,"sources":["/home/rachmat/Documents/belajar/wieldy-v-2.5.2/starter-templete-jwt-auth/src/authentication/auth-methods/jwt-auth/index.js"],"names":["useEffect","useState","useContext","httpClient","useProvideAuth","user","authUser","setAuthUser","error","setError","isLoadingUser","setLoadingUser","isLoading","setLoading","console","log","fetchStart","fetchSuccess","fetchError","userLogin","callbackFun","get","username","password","then","data","result","defaults","headers","common","token","access_token","localStorage","setItem","getAuthUser","catch","message","userSignup","post","sendPasswordResetEmail","setTimeout","confirmPasswordReset","code","renderSocialMediaLogin","userSignOut","removeItem","getItem","aaaa"],"mappings":"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","sourcesContent":["import { useEffect, useState ,useContext} from 'react';\nimport {httpClient} from \"../../../util/Api\";\n\nexport const useProvideAuth = ({user}) => {\n  const [authUser, setAuthUser] = useState(null);\n  const [error, setError] = useState('');\n  const [isLoadingUser, setLoadingUser] = useState(true);\n  const [isLoading, setLoading] = useState(false);\n\n\nconsole.log(\"ussess\", user)\n\n  const fetchStart = () => {\n    setLoading(true);\n    setError('');\n  };\n\n  const fetchSuccess = () => {\n    setLoading(false);\n    setError('');\n  };\n\n  const fetchError = (error) => {\n    setLoading(false);\n    setError(error);\n  };\n\n  const userLogin = (user, callbackFun) => {\n    console.log(\"user\",user)\n    fetchStart();\n    httpClient\n    // .post('/login', user)\n\n      .get(  'login?username='+user.username+'&password='+user.password, user)\n      .then(({ data }) => {\n        if (data.result) {\n          fetchSuccess();\n          httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n          localStorage.setItem('token', data.token.access_token);\n          getAuthUser();\n          if (callbackFun) callbackFun();\n        } else {\n          fetchError(data.error);\n        }\n      })\n      .catch(function (error) {\n        fetchError(error.message);\n      });\n  };\n\n  const userSignup = (user, callbackFun) => {\n    fetchStart();\n    httpClient\n      .post('auth/register', user)\n      .then(({ data }) => {\n        if (data.result) {\n          fetchSuccess();\n          localStorage.setItem('token', data.token.access_token);\n          httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n          getAuthUser();\n          if (callbackFun) callbackFun();\n        } else {\n          fetchError(data.error);\n        }\n      })\n      .catch(function (error) {\n        fetchError(error.message);\n      });\n  };\n\n  const sendPasswordResetEmail = (username, callbackFun) => {\n    fetchStart();\n\n    setTimeout(() => {\n      fetchSuccess();\n      if (callbackFun) callbackFun();\n    }, 300);\n  };\n\n  const confirmPasswordReset = (code, password, callbackFun) => {\n    fetchStart();\n\n    setTimeout(() => {\n      fetchSuccess();\n      if (callbackFun) callbackFun();\n    }, 300);\n  };\n\n  const renderSocialMediaLogin = () => null;\n\n  const userSignOut = (callbackFun) => {\n    fetchStart();\n    httpClient\n      .post('auth/logout')\n      .then(({ data }) => {\n        if (data.result) {\n          fetchSuccess();\n          httpClient.defaults.headers.common['Authorization'] = '';\n          localStorage.removeItem('token');\n          setAuthUser(false);\n          if (callbackFun) callbackFun();\n        } else {\n          fetchError(data.error);\n        }\n      })\n      .catch(function (error) {\n        fetchError(error.message);\n      });\n  };\n\n  const getAuthUser = (user) => {\n    fetchStart();\n    httpClient\n      // .post('/login')\n      .get(  'login?username='+user.username+'&password='+user.password, user)\n\n      .then(({ data }) => {\n        if (data.user) {\n          fetchSuccess();\n          setAuthUser(data.user);\n        } else {\n          fetchError(data.error);\n        }\n      })\n      .catch(function (error) {\n        httpClient.defaults.headers.common['Authorization'] = '';\n        fetchError(error.message);\n      });\n  };\n\n  // Subscribe to user on mount\n  // Because this sets state in the callback it will cause any ...\n  // ... component that utilizes this hook to re-render with the ...\n  // ... latest auth object.\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    \n\n    if (token) {\n      httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n    }  const aaaa = (user) => {\n    httpClient\n    .get(  'login?username='+user.username+'&password='+user.password, user)\n    // .get(  'login?username=&password=')\n      .then(({ data }) => {\n        if (data.user) {\n          setAuthUser(data.user);\n        }\n        setLoadingUser(false);\n      })\n      .catch(function () {\n        localStorage.removeItem('token');\n        httpClient.defaults.headers.common['Authorization'] = '';\n        setLoadingUser(false);\n      })}\n  }, []);\n\n  // Return the user object and auth methods\n  return {\n    isLoadingUser,\n    isLoading,\n    authUser,\n    error,\n    setError,\n    setAuthUser,\n    getAuthUser,\n    userLogin,\n    userSignup,\n    userSignOut,\n    renderSocialMediaLogin,\n    sendPasswordResetEmail,\n    confirmPasswordReset,\n  };\n};\n"]},"metadata":{},"sourceType":"module"}